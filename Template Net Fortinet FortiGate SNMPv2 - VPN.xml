<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>4.4</version>
    <date>2020-03-20T18:39:07Z</date>
    <groups>
        <group>
            <name>Templates/Network devices</name>
        </group>
    </groups>
    <templates>
        <template>
            <template>Template Net Fortinet FortiGate SNMPv2 - VPN</template>
            <name>Template Net Fortinet FortiGate SNMPv2 - VPN</name>
            <description>FORTINET-FORTIGATE-MIB&#13;
&#13;
# Author: Michel Barbosa&#13;
# URL: https://github.com/barbosm/fortinet-zabbix&#13;
# Version: 2020-03-20-1532</description>
            <groups>
                <group>
                    <name>Templates/Network devices</name>
                </group>
            </groups>
            <applications>
                <application>
                    <name>IPsec VPN</name>
                </application>
                <application>
                    <name>SSL VPN</name>
                </application>
            </applications>
            <items>
                <item>
                    <name>SSL VPN State</name>
                    <type>SNMPV2</type>
                    <snmp_community>public</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.12.2.3.1.1.1</snmp_oid>
                    <key>fgVpnSslState</key>
                    <description>FORTINET-FORTIGATE-MIB::fgVpnSslState&#13;
&#13;
Whether SSL-VPN is enabled on this virtual domain</description>
                    <applications>
                        <application>
                            <name>SSL VPN</name>
                        </application>
                    </applications>
                    <valuemap>
                        <name>FORTINET-CORE-MIB::FnBoolState</name>
                    </valuemap>
                </item>
                <item>
                    <name>Active SSL VPN Users</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.12.2.3.1.2.1</snmp_oid>
                    <key>fgVpnSslStatsLoginUsers</key>
                    <description>FORTINET-FORTIGATE-MIB::fgVpnSslStatsLoginUsers&#13;
&#13;
The current number of users logged in through SSL-VPN tunnels in the virtual domain</description>
                    <applications>
                        <application>
                            <name>SSL VPN</name>
                        </application>
                    </applications>
                </item>
                <item>
                    <name>Active IPsec VPN tunnels</name>
                    <type>SNMPV2</type>
                    <snmp_community>{$SNMP_COMMUNITY}</snmp_community>
                    <snmp_oid>.1.3.6.1.4.1.12356.101.12.1.1.0</snmp_oid>
                    <key>fgVpnTunnelUpCount</key>
                    <description>FORTINET-FORTIGATE-MIB::fgVpnTunnelUpCount&#13;
&#13;
The number of IPsec VPN tunnels with at least one SA</description>
                    <applications>
                        <application>
                            <name>IPsec VPN</name>
                        </application>
                    </applications>
                </item>
            </items>
        </template>
    </templates>
    <graphs>
        <graph>
            <name>Active VPN tunnels</name>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <item>
                        <host>Template Net Fortinet FortiGate SNMPv2 - VPN</host>
                        <key>fgVpnTunnelUpCount</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>0080FF</color>
                    <item>
                        <host>Template Net Fortinet FortiGate SNMPv2 - VPN</host>
                        <key>fgVpnSslStatsLoginUsers</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
    <value_maps>
        <value_map>
            <name>FORTINET-CORE-MIB::FnBoolState</name>
            <mappings>
                <mapping>
                    <value>1</value>
                    <newvalue>disabled</newvalue>
                </mapping>
                <mapping>
                    <value>2</value>
                    <newvalue>enabled</newvalue>
                </mapping>
            </mappings>
        </value_map>
    </value_maps>
</zabbix_export>
